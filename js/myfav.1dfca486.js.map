{"version":3,"sources":["webpack:///./src/views/Myfav.vue?64c4","webpack:///src/views/Myfav.vue","webpack:///./src/views/Myfav.vue?651f","webpack:///./src/views/Myfav.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","images","length","directives","name","rawName","_l","image","idx","key","staticClass","modifiers","on","$event","showModal","src","staticStyle","_s","title","showModalTF","index","description","unfavorite","favorite","toAuthor","avatar","_e","user","staticRenderFns","data","userid","myfavorites","methods","$store","commit","axios","get","$router","push","splice","patch","likedOrnot","computed","getters","author","mounted","beforeRouteLeave","next","component"],"mappings":"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","file":"js/myfav.1dfca486.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"myfav\"}},[_c('b-container',[_c('h3',[_vm._v(\"我的收藏\")]),(this.images.length===0)?_c('p',[_vm._v(\"沒有任何收藏\")]):_c('b-row',{directives:[{name:\"masonry\",rawName:\"v-masonry\"}],attrs:{\"transition-duration\":\"0.3s\",\"item-selector\":\".item\"}},_vm._l((_vm.images),function(image,idx){return _c('b-col',{directives:[{name:\"masonry-tile\",rawName:\"v-masonry-tile\"}],key:idx,staticClass:\"item\",attrs:{\"col\":\"\",\"cols\":\"12\",\"lg\":\"3\"}},[_c('b-card',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.modal-img-public\",modifiers:{\"modal-img-public\":true}}],on:{\"click\":function($event){return _vm.showModal(idx)}}},[_c('b-card-img',{attrs:{\"src\":image.src}}),_c('b-card-title',{staticStyle:{\"color\":\"white\",\"text-shadow\":\"0 0 4px #333\"}},[_vm._v(_vm._s(image.title))])],1)],1)}),1)],1),(_vm.images.length!==0&&_vm.showModalTF)?_c('b-modal',{attrs:{\"id\":\"modal-img-public\",\"size\":\"xl\",\"hide-footer\":\"\",\"hide-header\":\"\"}},[_c('b-btn',{attrs:{\"id\":\"goFront\",\"variant\":\"light\"},on:{\"click\":function($event){return _vm.showModal(_vm.index-1)}}},[_vm._v(\"<<\")]),_c('b-btn',{attrs:{\"id\":\"goForw\",\"variant\":\"light\"},on:{\"click\":function($event){return _vm.showModal(_vm.index+1)}}},[_vm._v(\">>\")]),_c('div',{staticClass:\"inner\"},[_c('b-row',[_c('b-col',{attrs:{\"col\":\"\",\"cols\":\"12\",\"md\":\"9\"}},[_c('div',{staticClass:\"cardimg\"},[_c('b-card-img',{attrs:{\"src\":_vm.images[_vm.index].src}})],1),_c('b-card-body')],1),_c('b-col',{attrs:{\"col\":\"\",\"cols\":\"12\",\"md\":\"3\"}},[_c('b-card-title',[_vm._v(_vm._s(_vm.images[_vm.index].title))]),_c('b-card-text',[_vm._v(_vm._s(_vm.images[_vm.index].description))]),(_vm.images[_vm.index].liked)?_c('span',{staticClass:\"heart\",on:{\"click\":_vm.unfavorite}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas','heart']}}),_c('span',{staticClass:\"position-absolute\",staticStyle:{\"bottom\":\"-70%\",\"left\":\"0\",\"font-size\":\"18px\"}},[_vm._v(\"點擊取消\")])],1):_c('span',{staticClass:\"heart\",on:{\"click\":_vm.favorite}},[_c('font-awesome-icon',{attrs:{\"icon\":['far','heart']}}),_c('span',{staticClass:\"position-absolute\",staticStyle:{\"bottom\":\"-70%\",\"left\":\"0\",\"font-size\":\"18px\"}},[_vm._v(\"點擊收藏\")])],1),_c('div',[_c('span',{staticStyle:{\"color\":\"#777\"}},[_vm._v(\"BY\")]),_c('div',{staticClass:\"round\",staticStyle:{\"margin-bottom\":\"10px\"},on:{\"click\":_vm.toAuthor}},[(_vm.avatar.length!==0)?_c('img',{attrs:{\"src\":_vm.avatar[0].src}}):_vm._e()]),_c('a',{staticStyle:{\"color\":\"#777\"},on:{\"click\":_vm.toAuthor}},[_vm._v(_vm._s(_vm.images[_vm.index].user))])]),_c('div',[_c('p',{staticStyle:{\"padding-left\":\"10px\"}},[_vm._v(\"分享至：\")]),_c('font-awesome-icon',{staticStyle:{\"margin\":\"0 10px 20px 10px\",\"font-size\":\"30px\"},attrs:{\"icon\":['fab','facebook-square']}}),_c('font-awesome-icon',{staticStyle:{\"margin\":\"0 10px 20px 10px\",\"font-size\":\"30px\"},attrs:{\"icon\":['fab','twitter-square']}})],1)],1)],1)],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  #myfav\n    b-container\n      h3 我的收藏\n      p(v-if=\"this.images.length===0\") 沒有任何收藏\n      b-row(v-else v-masonry transition-duration=\"0.3s\" item-selector=\".item\")\n        b-col.item(col cols=\"12\" lg=\"3\" v-for=\"(image,idx) in images\" :key=\"idx\" v-masonry-tile)\n          b-card(v-b-modal.modal-img-public @click=\"showModal(idx)\")\n            b-card-img(:src=\"image.src\")\n            b-card-title(style=\"color:white;text-shadow:0 0 4px #333\") {{image.title}}\n    //- Modal\n    b-modal#modal-img-public(size=\"xl\" hide-footer hide-header v-if=\"images.length!==0&&showModalTF\")\n      b-btn#goFront(variant=\"light\" @click=\"showModal(index-1)\") <<\n      b-btn#goForw(variant=\"light\" @click=\"showModal(index+1)\") >>\n      div.inner\n        b-row\n          b-col(col cols=\"12\" md=\"9\")\n            div.cardimg\n              b-card-img(:src=\"images[index].src\")\n            b-card-body\n          b-col(col cols=\"12\" md=\"3\")\n            //- 標題\n            b-card-title {{images[index].title}}\n            //- 描述\n            b-card-text {{images[index].description}}\n            span.heart(v-if=\"images[index].liked\" @click=\"unfavorite\")\n              font-awesome-icon(:icon=\"['fas','heart']\")\n              span.position-absolute(style=\"bottom:-70%;left:0;font-size:18px\") 點擊取消\n            span.heart(v-else @click=\"favorite\")\n              font-awesome-icon(:icon=\"['far','heart']\")\n              span.position-absolute(style=\"bottom:-70%;left:0;font-size:18px\") 點擊收藏\n            //- 作者\n            div\n              span(style=\"color:#777\") BY\n              div.round(@click=\"toAuthor\" style=\"margin-bottom:10px\")\n                img(v-if=\"avatar.length!==0\" :src=\"avatar[0].src\")\n              a(@click=\"toAuthor\" style=\"color:#777\") {{images[index].user}}\n            //- 分享\n            div\n              p(style=\"padding-left:10px\") 分享至：\n              font-awesome-icon(:icon=\"['fab','facebook-square']\" style=\"margin:0 10px 20px 10px;font-size:30px\")\n              font-awesome-icon(:icon=\"['fab','twitter-square']\" style=\"margin:0 10px 20px 10px;font-size:30px\")\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      images: [],\n      index: '0',\n      userid: '',\n      myfavorites: [],\n      avatar: [{ src: '000' }],\n      showModalTF: false\n    }\n  },\n  methods: {\n    showModal (idx) {\n      this.showModalTF = true\n      if (idx < 0) {\n        this.index = this.images.length - 1\n      } else if (idx === this.images.length) {\n        this.index = 0\n      } else {\n        this.index = idx\n      }\n      this.$store.commit('author', this.images[this.index].user)\n      // avatar\n      this.axios.get(process.env.VUE_APP_APIURL + '/avatar/' + this.author)\n        .then(response => {\n          this.avatar = response.data.result.map(d => {\n            return {\n              src: process.env.VUE_APP_APIURL + '/avatar/image/' + d.name\n            }\n          })\n        })\n        .catch((error) => {\n          console.log(error)\n          this.$swal({\n            title: '發生錯誤',\n            icon: 'error',\n            confirmButtonText: '知道了'\n          })\n        })\n    },\n    toAuthor () {\n      if (this.images[this.index].user !== 'none') {\n        this.$store.commit('author', this.images[this.index].user)\n        this.$router.push('/author')\n      }\n    },\n    unfavorite () {\n      this.myfavorites.splice(this.index, 1)\n      this.axios.patch(process.env.VUE_APP_APIURL + '/users/edit/' + this.userid, { account: this.user, favorite: this.myfavorites })\n        .then(response => {\n          this.images.splice(this.index, 1)\n        })\n        .catch((error) => {\n          console.log(error)\n          this.$swal({\n            title: '取消失敗',\n            text: '發生錯誤',\n            icon: 'error',\n            confirmButtonText: '知道了'\n          })\n        })\n    },\n    likedOrnot () {\n      for (var myfavorite of this.myfavorites) {\n        var index = -1\n        this.images.find(function (item, i) {\n          if (item._id === myfavorite) {\n            index = i\n          }\n        })\n        this.images[index].liked = true\n      }\n    }\n  },\n  computed: {\n    user () {\n      return this.$store.getters.user\n    },\n    author () {\n      return this.$store.getters.author\n    }\n  },\n  mounted () {\n    this.axios.get(process.env.VUE_APP_APIURL + '/users/' + this.user)\n      .then(response => {\n        const result = response.data.result[0]\n        this.userid = result._id\n        this.myfavorites = result.favorite\n      })\n      .catch((error) => {\n        console.log(error)\n        this.$swal({\n          title: '發生錯誤',\n          icon: 'error',\n          confirmButtonText: '知道了'\n        })\n      })\n    this.axios.get(process.env.VUE_APP_APIURL + '/')\n      .then(response => {\n        const result = []\n        for (let i = 0; i < this.myfavorites.length; i++) {\n          let index = -1\n          const myfavorite = this.myfavorites[i]\n          response.data.result.find(function (item, j) {\n            if (item._id === myfavorite) {\n              index = j\n            }\n          })\n          if (index === -1) {\n            this.myfavorites.splice(i, 1)\n            this.axios.patch(process.env.VUE_APP_APIURL + '/users/edit/' + this.userid, { account: this.user, favorite: this.myfavorites })\n              .then(response => {\n\n              })\n              .catch((error) => {\n                console.log(error)\n                this.$swal({\n                  title: '取消失敗',\n                  text: '發生錯誤',\n                  icon: 'error',\n                  confirmButtonText: '知道了'\n                })\n              })\n          } else {\n            result.push(response.data.result[index])\n          }\n        }\n        this.images = result.map(d => {\n          return {\n            title: d.title,\n            description: d.description,\n            src: process.env.VUE_APP_APIURL + '/file/' + d.name,\n            _id: d._id,\n            user: d.user,\n            liked: true\n          }\n        })\n      })\n      .catch((error) => {\n        console.log(error)\n        this.$swal({\n          title: '發生錯誤',\n          icon: 'error',\n          confirmButtonText: '知道了'\n        })\n      })\n  },\n  beforeRouteLeave (to, from, next) {\n    this.showModalTF = false\n    next()\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Myfav.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Myfav.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Myfav.vue?vue&type=template&id=cdeb206c&lang=pug&\"\nimport script from \"./Myfav.vue?vue&type=script&lang=js&\"\nexport * from \"./Myfav.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}