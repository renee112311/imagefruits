(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["myalbum"],{"2e63":function(t,e,i){t.exports=i.p+"img/berry.0a1c3572.png"},"91ea":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"myalbum"}},[s("b-container",[s("span",{staticStyle:{cursor:"pointer","margin-bottom":"1.5rem","font-size":"18px"},on:{click:t.tomyimages}},[t._v("<<返回「我的圖片」")]),s("div",{attrs:{id:"albumCover"}},[void 0!==t.images[0]?s("img",{attrs:{src:t.images[0].src}}):t._e(),t.edit?s("b-form-input",{model:{value:t.model_titl,callback:function(e){t.model_titl=e},expression:"model_titl"}}):s("h3",[t._v(t._s(this.title))]),t.edit?s("b-form-textarea",{model:{value:t.model_des,callback:function(e){t.model_des=e},expression:"model_des"}}):s("p",[t._v(t._s(this.description))])],1),this.select?s("div",[s("b-btn",{on:{click:t.multidelete}},[t._v("一併刪除")]),s("b-btn",{on:{click:t.selectCancel}},[t._v("取消選取")]),0===t.images.length?s("p",[t._v("沒有任何圖片，快去上傳吧")]):s("b-row",t._l(t.images,(function(e,n){return s("b-col",{key:n,attrs:{col:"",cols:"12",lg:"3"}},[s("b-card",{on:{click:function(e){return t.multiselect(n)}}},[e.checked?s("img",{staticClass:"berry",attrs:{src:i("2e63")}}):t._e(),s("b-card-img",{attrs:{src:e.src}})],1)],1)})),1)],1):s("div",[t.edit?s("b-btn",{on:{click:t.selectOpen}},[t._v("選取")]):t._e(),t.edit?s("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-addNewImage",modifiers:{"modal-addNewImage":!0}}]},[t._v("新增圖片")]):s("b-btn",{on:{click:t.editAlbum}},[t._v("編輯相簿")]),t.edit?s("b-btn",{on:{click:t.updateAlbum}},[t._v("儲存修改")]):t._e(),t.edit?s("b-btn",{on:{click:t.cancelAlbum}},[t._v("取消修改")]):s("b-btn",{on:{click:t.deleteAlbum}},[t._v("刪除相簿")]),0===t.images.length?s("p",[t._v("沒有任何圖片，快去上傳吧")]):s("b-row",{directives:[{name:"masonry",rawName:"v-masonry"}],staticClass:"notinselect",attrs:{"transition-duration":"0.3s","item-selector":".item"}},t._l(t.images,(function(e,i){return s("b-col",{directives:[{name:"masonry-tile",rawName:"v-masonry-tile"}],key:i,staticClass:"item",attrs:{col:"",cols:"12",lg:"3"}},[s("b-card",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-img",modifiers:{"modal-img":!0}}],on:{click:function(e){return t.showModal(i)}}},[s("b-card-img",{attrs:{src:e.src}}),s("b-card-title",{staticStyle:{color:"white","text-shadow":"0 0 4px #333"}},[t._v(t._s(e.title))])],1)],1)})),1)],1),0!==t.images.length&&t.showModalTF?s("b-modal",{attrs:{id:"modal-img",size:"xl","hide-footer":"","hide-header":""}},[s("b-btn",{attrs:{id:"goFront",variant:"light"},on:{click:function(e){return t.showModal(t.index-1)}}},[t._v("<<")]),s("b-btn",{attrs:{id:"goForw",variant:"light"},on:{click:function(e){return t.showModal(t.index+1)}}},[t._v(">>")]),s("div",{staticClass:"inner"},[s("b-button",{staticClass:"d-block d-sm-none",attrs:{size:"sm"},on:{click:function(e){return t.$bvModal.hide("modal-img")}}},[t._v("X")]),s("b-row",[s("b-col",{staticClass:"w-100",staticStyle:{"text-align":"center"}},[s("b-card-img",{attrs:{src:t.images[t.index].src}})],1),s("div",{staticClass:"w-100",staticStyle:{height:"1px"}}),s("b-col",[s("b-card-body",[s("table",[s("tr",[s("td",[t.images[t.index].edit?s("b-form-select",{attrs:{options:t.privacyOp},model:{value:t.images[t.index].model_privacy,callback:function(e){t.$set(t.images[t.index],"model_privacy",e)},expression:"images[index].model_privacy"}}):s("span",{staticStyle:{color:"#888"},on:{click:function(e){return t.editimg(t.index)}}},[t._v("("+t._s(t.images[t.index].privacy)+")")])],1),s("td")]),s("tr",[s("td",[t.images[t.index].edit?s("b-form-input",{on:{blur:function(e){return t.update(t.index)}},model:{value:t.images[t.index].model_titl,callback:function(e){t.$set(t.images[t.index],"model_titl",e)},expression:"images[index].model_titl"}}):s("span",{staticStyle:{"font-size":"30px"},attrs:{id:"imgtitle"},on:{click:function(e){return t.editimg(t.index)}}},[t._v(t._s(t.images[t.index].title))])],1),s("td")]),s("tr",[s("td",[t.images[t.index].edit?s("b-form-textarea",{on:{blur:function(e){return t.update(t.index)}},model:{value:t.images[t.index].model_des,callback:function(e){t.$set(t.images[t.index],"model_des",e)},expression:"images[index].model_des"}}):s("span",{attrs:{id:"imgdesc"},on:{click:function(e){return t.editimg(t.index)}}},[t._v(t._s(t.images[t.index].description))])],1),s("td")]),s("tr",[s("td",[t.images[t.index].edit?t._e():s("b-btn",{attrs:{variant:"light"},on:{click:function(e){return t.edit(t.index)}}},[s("font-awesome-icon",{attrs:{icon:["far","edit"]}})],1)],1),s("td",[s("b-btn",{attrs:{variant:"light"},on:{click:function(e){return t.del(t.index)}}},[s("font-awesome-icon",{attrs:{icon:["far","trash-alt"]}})],1)],1)])])])],1),s("b-col",[s("b-card-footer",[s("table",[s("tr",[s("td",[s("span",[t._v("圖片連結")])]),s("td")]),s("tr",[s("td",{staticClass:"d-none d-xl-table-cell",attrs:{width:"50%"}},[s("span",[t._v(t._s(t.images[t.index].src))])]),s("td",[s("b-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.images[t.index].src,expression:"images[index].src",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{type:"button"}},[t._v("複製")])],1)]),s("tr",[s("td",[s("span",[t._v("HTML")])]),s("td")]),s("tr",[s("td",{staticClass:"d-none d-xl-table-cell",attrs:{width:"50%"}},[s("span",[t._v('<img src="'+t._s(t.images[t.index].src)+'">')])]),s("td",[s("b-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:"<img src="+t.images[t.index].src+">",expression:"'<img src='+images[index].src+'>'",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{type:"button"}},[t._v("複製")])],1)]),s("tr",[s("td",[s("span",[t._v("Markdown")])]),s("td")]),s("tr",[s("td",{staticClass:"d-none d-xl-table-cell",attrs:{width:"50%"}},[s("span",[t._v("![]("+t._s(t.images[t.index].src)+")")])]),s("td",[s("b-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:"![]("+t.images[t.index].src+")",expression:"'![]('+images[index].src+')'",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{type:"button"}},[t._v("複製")])],1)])])])],1)],1)],1)],1):t._e(),s("b-modal",{attrs:{id:"modal-addNewImage",size:"xl","hide-footer":""}},[s("p",[t._v("尚未被列入相簿的圖片：")]),s("b-btn",{on:{click:t.selectCancel2}},[t._v("取消選取")]),s("b-btn",{on:{click:t.addImages}},[t._v("加入到相簿")]),0===t.newImages.length?s("p",[t._v("沒有任何圖片，快去上傳吧")]):s("b-row",t._l(t.newImages,(function(e,n){return s("b-col",{key:n,attrs:{col:"",cols:"12",lg:"3"}},[s("b-card",{on:{click:function(e){return t.multiselect2(n)}}},[e.checked?s("img",{staticClass:"berry",attrs:{src:i("2e63")}}):t._e(),s("b-card-img",{attrs:{src:e.src}})],1)],1)})),1)],1)],1)],1)},n=[],o=(i("a4d3"),i("e01a"),i("4de4"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("b85c")),a={data:function(){return{title:"",description:"",model_titl:"",model_des:"",id:"",images:[],newImages:[],options:[],albums:null,index:"0",select:!1,edit:!1,privacyOp:["公開","私人"],showModalTF:!1}},methods:{showModal:function(t){this.showModalTF=!0,t<0?this.index=this.images.length-1:t===this.images.length?this.index=0:this.index=t},validateText:function(){this.description.length>150?this.textstate=!1:this.textstate=!0},editAlbum:function(){this.edit=!0},updateAlbum:function(){var t=this;this.axios.patch("https://imagefruits.herokuapp.com/albums/"+this.id,{title:this.model_titl,description:this.model_des}).then((function(e){t.edit=!1,t.title=t.model_titl,t.description=t.model_des,t.$store.commit("album",t.title)})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}));for(var e=0;e<this.images.length;e++)this.axios.patch("https://imagefruits.herokuapp.com/file/"+this.images[e]._id,{album:this.model_titl}).then((function(t){})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},cancelAlbum:function(){this.edit=!1,this.model_titl=this.title,this.model_des=this.description},deleteAlbum:function(){var t=this;this.$swal.fire({title:"確定要刪除相簿？?",text:"圖片本身不會被刪除",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"是",cancelButtonText:"否"}).then((function(e){e.value&&t.axios.delete("https://imagefruits.herokuapp.com/albums/"+t.id).then((function(e){for(var i=0;i<t.images.length;i++)t.axios.patch("https://imagefruits.herokuapp.com/file/"+t.images[i]._id,{album:"null"}).then((function(t){})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}));t.$router.push("/myimages")})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))}))},editimg:function(t){this.images[t].edit=!0,this.images[t].model_titl=this.images[t].title,this.images[t].model_des=this.images[t].description},update:function(t){var e=this;this.axios.patch("https://imagefruits.herokuapp.com/file/"+this.images[t]._id,{title:this.images[t].model_titl,description:this.images[t].model_des,privacy:this.images[t].model_privacy}).then((function(i){e.images[t].edit=!1,e.images[t].title=e.images[t].model_titl,e.images[t].description=e.images[t].model_des,e.images[t].privacy=e.images[t].model_privacy})).catch((function(){e.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},del:function(t){var e=this;this.axios.delete("https://imagefruits.herokuapp.com/file/"+this.images[t]._id).then((function(i){e.images.splice(t,1)})).catch((function(){e.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},onCopy:function(t){this.$swal({title:"已複製到剪貼簿",icon:"success",confirmButtonText:"知道了"})},onError:function(t){this.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})},selectOpen:function(){this.select=!0,this.edit=!1},selectCancel:function(){this.select=!1,this.options.length=0;var t,e=Object(o["a"])(this.images);try{for(e.s();!(t=e.n()).done;){var i=t.value;i.checked=!1}}catch(s){e.e(s)}finally{e.f()}},selectCancel2:function(){this.options.length=0;var t,e=Object(o["a"])(this.newImages);try{for(e.s();!(t=e.n()).done;){var i=t.value;i.checked=!1}}catch(s){e.e(s)}finally{e.f()}},multiselect:function(t){this.images[t].checked?(this.options.splice(this.options.indexOf(this.images[t]),1),this.images[t].checked=!1):(this.options.push(this.images[t]),this.images[t].checked=!0)},multiselect2:function(t){this.newImages[t].checked?(this.options.splice(this.options.indexOf(this.newImages[t]),1),this.newImages[t].checked=!1):(this.options.push(this.newImages[t]),this.newImages[t].checked=!0)},multidelete:function(){for(var t=this,e=0;e<this.options.length;e++)this.axios.patch("https://imagefruits.herokuapp.com/file/"+this.options[e]._id,{album:"null"}).then((function(e){t.select=!1,t.options.length=0,location.reload();var i,s=Object(o["a"])(t.images);try{for(s.s();!(i=s.n()).done;){var n=i.value;n.checked=!1}}catch(a){s.e(a)}finally{s.f()}})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},addImages:function(){for(var t=this,e=0;e<this.options.length;e++)this.axios.patch("https://imagefruits.herokuapp.com/file/"+this.options[e]._id,{album:this.album}).then((function(e){t.select=!1,t.options.length=0;var i,s=Object(o["a"])(t.newImages);try{for(s.s();!(i=s.n()).done;){var n=i.value;n.checked=!1}}catch(a){s.e(a)}finally{s.f()}location.reload()})).catch((function(){t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},tomyimages:function(){this.$router.push("/myimages")}},computed:{user:function(){return this.$store.getters.user},album:function(){return this.$store.getters.album}},mounted:function(){var t=this;this.axios.get("https://imagefruits.herokuapp.com/author/"+this.user).then((function(e){var i=e.data.result.filter((function(e){return e.album===t.album}));t.images=i.map((function(t){return{title:t.title,description:t.description,privacy:t.privacy,src:"https://imagefruits.herokuapp.com/file/"+t.name,_id:t._id,checked:!1,edit:!1,model_titl:t.title,model_des:t.description,model_privacy:t.privacy,album:t.album}}))})).catch((function(e){console.log(e),t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})})),this.axios.get("https://imagefruits.herokuapp.com/albums/"+this.user).then((function(e){var i=e.data.result.filter((function(e){return e.title===t.album}));t.albums=i.map((function(t){return{title:t.title,description:t.description,_id:t._id,model_titl:t.title,model_des:t.description}})),i=i[0],t.title=i.title,t.description=i.description,t.id=i._id,t.model_titl=i.title,t.model_des=i.description})).catch((function(e){console.log(e),t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})})),this.axios.get("https://imagefruits.herokuapp.com/author/"+this.user).then((function(e){var i=e.data.result.filter((function(t){return"null"===t.album}));t.newImages=i.map((function(t){return{title:t.title,desc:t.description,src:"https://imagefruits.herokuapp.com/file/"+t.name,_id:t._id,album:t.album,checked:!1}}))})).catch((function(e){console.log(e),t.$swal({title:"發生錯誤",icon:"error",confirmButtonText:"知道了"})}))},beforeRouteLeave:function(t,e,i){this.showModalTF=!1,i()}},r=a,c=i("2877"),l=Object(c["a"])(r,s,n,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=myalbum.6ca759e6.js.map