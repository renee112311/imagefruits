{"version":3,"sources":["webpack:///./src/views/Newalbum.vue?fc23","webpack:///src/views/Newalbum.vue","webpack:///./src/views/Newalbum.vue?fe97","webpack:///./src/views/Newalbum.vue","webpack:///./src/assets/berry.png"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","on","selectCancel","images","length","_l","image","idx","key","$event","multiselect","staticClass","_e","src","createAlbum","titlestate","validateText","model","value","callback","$$v","title","expression","descstate","description","staticRenderFns","data","index","options","methods","event","preventDefault","$swal","text","icon","confirmButtonText","axios","post","checked","splice","indexOf","push","computed","user","$store","getters","mounted","get","component","module","exports"],"mappings":"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","file":"js/newalbum.8c3dc922.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"newalbum\"}},[_c('b-container',[_c('h3',[_vm._v(\"新增相簿\")]),_c('p',[_vm._v(\"尚未被列入相簿的圖片：\")]),_c('b-btn',{on:{\"click\":_vm.selectCancel}},[_vm._v(\"取消選取\")]),(_vm.images.length===0)?_c('p',[_vm._v(\"沒有任何圖片，快去上傳吧\")]):_c('b-row',_vm._l((_vm.images),function(image,idx){return _c('b-col',{key:idx,attrs:{\"col\":\"\",\"cols\":\"12\",\"lg\":\"2\"}},[_c('b-card',{on:{\"click\":function($event){return _vm.multiselect(idx)}}},[(image.checked)?_c('img',{staticClass:\"berry\",attrs:{\"src\":require(\"../assets/berry.png\")}}):_vm._e(),_c('b-card-img',{attrs:{\"src\":image.src}})],1)],1)}),1),_c('b-form',{on:{\"submit\":_vm.createAlbum}},[_c('b-form-input',{attrs:{\"placeholder\":\"相簿標題\",\"state\":_vm.titlestate},on:{\"input\":_vm.validateText},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}}),_c('b-form-textarea',{attrs:{\"placeholder\":\"相簿說明\",\"rows\":\"3\",\"max-rows\":\"6\",\"maxlength\":\"200\",\"state\":_vm.descstate},on:{\"input\":_vm.validateText},model:{value:(_vm.description),callback:function ($$v) {_vm.description=$$v},expression:\"description\"}},[_c('br')]),_c('b-button',{attrs:{\"type\":\"createAlbum\"}},[_vm._v(\"新增相簿\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  #newalbum\n    b-container\n      h3 新增相簿\n      p 尚未被列入相簿的圖片：\n      b-btn(@click=\"selectCancel\") 取消選取\n      p(v-if=\"images.length===0\") 沒有任何圖片，快去上傳吧\n      b-row(v-else)\n        b-col(col cols=\"12\" lg=\"2\" v-for=\"(image,idx) in images\" :key=\"idx\")\n          b-card(@click=\"multiselect(idx)\")\n            img.berry(v-if=\"image.checked\" src=\"../assets/berry.png\")\n            b-card-img(:src=\"image.src\")\n\n      b-form(@submit=\"createAlbum\")\n        b-form-input(\n            v-model=\"title\"\n            placeholder=\"相簿標題\"\n            @input=\"validateText\"\n            :state=\"titlestate\"\n          )\n        b-form-textarea(\n            v-model=\"description\"\n            placeholder=\"相簿說明\"\n            rows=\"3\" max-rows=\"6\"\n            maxlength=\"200\"\n            @input=\"validateText\"\n            :state=\"descstate\"\n          )\n          br\n        b-button(type=\"createAlbum\") 新增相簿\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      title: '',\n      description: '',\n      index: '0',\n      images: [],\n      options: [],\n      titlestate: null,\n      descstate: null\n    }\n  },\n  methods: {\n    validateText () {\n      if (this.title.length > 20) {\n        this.titlestate = false\n      } else {\n        this.titlestate = true\n      }\n      if (this.description.length > 150) {\n        this.descstate = false\n      } else {\n        this.descstate = true\n      }\n    },\n    selectCancel () {\n      this.options.length = 0\n      for (var image of this.images) {\n        image.checked = false\n      }\n    },\n    createAlbum (event) {\n      event.preventDefault()\n      if (this.title.length > 20) {\n        this.$swal({\n          title: '新增失敗',\n          text: '相簿標題格式不符',\n          icon: 'error',\n          confirmButtonText: '知道了'\n        })\n      } else if (this.description.length > 150) {\n        this.$swal({\n          title: '新增失敗',\n          text: '相簿說明格式不符',\n          icon: 'error',\n          confirmButtonText: '知道了'\n        })\n      }\n      for (var checked of this.options) {\n        this.axios.patch(process.env.VUE_APP_APIURL + '/file/' + checked._id, { album: this.title })\n          .then(response => {\n          })\n          .catch(() => {\n            this.$swal({\n              title: '發生錯誤',\n              icon: 'error',\n              confirmButtonText: '知道了'\n            })\n          })\n      }\n      this.axios.post(process.env.VUE_APP_APIURL + '/albums',\n        { user: this.user, title: this.title, description: this.description }\n      )\n        .then(response => {\n          const data = response.data\n          if (data.success) {\n            this.$router.push('/myimages')\n          } else {\n            this.$swal({\n              title: '發生錯誤',\n              text: data.message,\n              icon: 'error',\n              confirmButtonText: '知道了'\n            })\n          }\n        })\n        .catch(() => {\n          this.$swal({\n            title: '發生錯誤',\n            icon: 'error',\n            confirmButtonText: '知道了'\n          })\n        })\n    },\n    multiselect (idx) {\n      if (!this.images[idx].checked) {\n        this.options.push(this.images[idx])\n        this.images[idx].checked = true\n      } else {\n        this.options.splice(this.options.indexOf(this.images[idx]), 1)\n        this.images[idx].checked = false\n      }\n    }\n  },\n  computed: {\n    user () {\n      return this.$store.getters.user\n    }\n  },\n  mounted () {\n    this.axios.get(process.env.VUE_APP_APIURL + '/author/' + this.user)\n      .then(response => {\n        const result = response.data.result.filter(i => i.album === 'null')\n        this.images = result.map(d => {\n          return {\n            title: d.title,\n            desc: d.description,\n            src: process.env.VUE_APP_APIURL + '/file/' + d.name,\n            _id: d._id,\n            album: d.album,\n            checked: false\n          }\n        })\n      })\n      .catch((error) => {\n        console.log(error)\n        this.$swal({\n          title: '發生錯誤',\n          icon: 'error',\n          confirmButtonText: '知道了'\n        })\n      })\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Newalbum.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Newalbum.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Newalbum.vue?vue&type=template&id=7a92e7b9&lang=pug&\"\nimport script from \"./Newalbum.vue?vue&type=script&lang=js&\"\nexport * from \"./Newalbum.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/berry.0a1c3572.png\";"],"sourceRoot":""}